## 2.1 javaScript内存管理

### 2.1.1 js内存机制

🔥内存空间：栈内存（stack）、堆内存（heap）

1. 栈内存：所有原始数据类型都存储在栈内存中，从一个栈删除原始数据，遵循先进后出；如下图：a最先进栈，最后出栈。
![](~@/jsasvanced/stack.png)

2. 堆内存：引用数据类型会在堆内存中开辟一个空间，并且会有一个十六进制的内存地址，在栈内存中声明的变量的值就是十六进制的内存地址。

![](~@/jsasvanced/heap.png)

 函数也是引用数据类型，我们定一个函数的时候，会在堆内存中开辟空间，会以字符串的形式存储到堆内存中去，如下图：
 
 ![](~@/jsasvanced/function.png)

 ```javascript
 // 我们直接打印fn会出现一段字符窜
 console.log(fn)
  f fn() {
      var t=10;
      var f=10;
      console.log(i+j)
  }
  // 加上括号才执行里面的代码
  fn() // 20
  ```
 
### 2.1.2 垃圾回收
 🔥概念：（我们平时创建所有的数据类型都需要内存）
   所谓的垃圾回收就是找出那些不再继续使用的变量，然后释放出其所占用的内存，垃圾回收会按照固定的时间间隔周期性的执行这一操作。

 🔥javaScript使用的垃圾回收机制来自动管理内存，垃圾回收是把双刃剑；垃圾回收是不可见的

    优势：可以大幅简化程序的内存管理代码，降低程序员的负担，减少因长时间运转而带来的内存泄漏问题。

    不足：程序员无法掌控内存，javascript没有暴露任何关于内存的api，无法强迫进行垃圾回收，无法干预内存管理。

🔥 垃圾回收的方式

1. 引用计数（reference counting）

      跟踪记录每个值被引用的次数，如果一个值引用次数是0，就表示这个值不再用到了，因此可以将这块内存释放

      原理：每次引用加1，被释放减1，当这个值的引用次数变成0时，就将其内存空间释放。
 ```javascript
    let obj= {a:10}; // 引用+1
    let obj1={a:10} // 引用+1
    obj ={} //引用减1
    obj1=null //引用为0
 ``` 
引用计数的bug：循环引用
  ```javascript
    // ie8较早的浏览器,现在浏览器不会出现这个问题
    function Fn (){
        var objA={a:10}
        var objB={b:10}
        objA.c=objB
        objB.c=objA
    }
 ``` 
### V8内存机制









## 2.2 如何保证你的代码质量







## 2.3 提高代码的可靠性